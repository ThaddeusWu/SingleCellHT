% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_gene_counts.R
\name{generate_gene_counts}
\alias{generate_gene_counts}
\title{Generate gene counts from annotated isoform counts}
\arguments{
\item{isoform_counts}{Matrix or data frame of isoform-level counts with
isoform names as rownames. Each row represents an isoform, and each column
represents a cell or sample.}

\item{show_progress}{Logical indicating whether to show progress messages
(default: TRUE).}
}
\value{
A list containing two elements:
\itemize{
\item gene_counts: Data frame of gene-level counts where rows are genes
and columns are cells/samples
\item transcript_info: Data frame with columns:
\itemize{
\item transcript_id: Original isoform identifier
\item transcript_name: Original isoform name
\item gene_id: Associated gene identifier
\item gene_name: Associated gene name
}
}
}
\description{
Generates gene-level counts and transcript information from a fully annotated
isoform count matrix. This function converts an isoform-level expression matrix
into a gene-level expression matrix by summing up counts of isoforms belonging
to the same gene. The function assumes isoform names are in the format
"GENE-NUMBER" (e.g., "Fasl-201").
}
\details{
The function performs the following steps:
\enumerate{
\item Validates input format and extracts gene names from isoform identifiers
\item Converts data to efficient format for processing
\item Aggregates isoform counts to gene level
\item Creates necessary transcript information
\item Returns results in format compatible with SCHT analysis
}
}
\examples{
\dontrun{
# Create example data
isoform_mat <- matrix(
  rnorm(20), nrow = 4,
  dimnames = list(
    c("Gene1-201", "Gene1-202", "Gene2-201", "Gene2-202"),
    c("cell1", "cell2", "cell3", "cell4", "cell5")
  )
)

# Generate gene counts
result <- generate_gene_counts(isoform_mat)

# Access results
gene_counts <- result$gene_counts
transcript_info <- result$transcript_info
}

}
